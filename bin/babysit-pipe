#!/usr/bin/env bash

set -e

base_url="localhost:8888/api/babysitter/signal"

key="$1"
if [ -z "$key" ]; then
  key="UNKNOWN"
fi
random_value="$(cat /dev/urandom | tr -dc 'a-zA-Z0-9' | fold -w 32 | head -n 1)"

printf "> Babysitting...\n"
curl "${base_url}?type=start&key=${key}&id=${random_value}" > /dev/null 2>&1

# Pipe stdin back to stdout
cat <&0

printf "> Babysat.\n"
curl "${base_url}?type=end&key=${key}&id=${random_value}" > /dev/null 2>&1

